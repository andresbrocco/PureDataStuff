#N canvas 242 1105 720 847 10;
#X obj 25 357 float;
#X floatatom 64 444 0 0 0 0 - - - 0;
#X obj 23 539 pack f f;
#X msg 23 561 0 \, \$1 \$2;
#X obj 23 586 vline~;
#X obj 25 296 mtof;
#X obj 25 240 stripnote;
#X obj 291 385 * 0.008;
#X obj 291 418 t f f;
#X obj 341 384 unpack f f f f;
#X obj 23 638 *~;
#X obj 25 213 unpack f f f;
#X obj 93 491 *;
#X obj 68 514 /;
#X floatatom 108 445 5 0 0 0 - - - 0;
#X obj 25 270 - 0;
#X obj 53 16 inlet;
#X obj 23 679 outlet~;
#X obj 23 658 *~ 0.3;
#N canvas 1027 338 450 300 adsr 0;
#X obj 105 111 inlet;
#X obj 435 151 inlet;
#X text 101 86 trigger;
#X obj 105 139 sel 0;
#X obj 244 155 t b;
#X obj 166 264 f \$1;
#X obj 166 289 pack 0 \$2;
#X obj 492 151 inlet;
#X obj 438 281 del \$2;
#X obj 458 429 line~;
#X obj 462 304 f \$4;
#X obj 501 379 pack 0 \$3;
#X obj 554 151 inlet;
#X obj 616 151 inlet;
#X obj 689 150 inlet;
#X msg 105 170 stop;
#X obj 612 306 pack 0 \$5;
#X text 435 129 level;
#X obj 501 355 * \$1;
#X obj 458 454 outlet~;
#X text 102 378 and pack with;
#X text 103 398 attack time;
#X text 31 126 if zero;
#X text 32 143 release;
#X text 12 160 and cancel;
#X text 43 177 decay;
#X text 284 272 on attack \, set a;
#X text 278 305 recall sustain value;
#X text 315 378 pack with decay time;
#X text 605 332 on release ramp;
#X text 606 349 back to zero;
#X obj 462 329 * 0.01;
#X text 47 567 Objects such as "f" and "pack" can be given dollar sign arguments to initialize their contents from adsr's creation arguments. Inlets are supplied to change them on the fly.;
#X text 13 2 ADSR ENVELOPE;
#X text 488 129 attack;
#X text 555 128 decay;
#X text 609 129 sustain;
#X text 686 129 release;
#X text 202 71 attack;
#X obj 204 92 moses;
#X obj 194 122 t b b;
#X msg 128 290 0;
#X text 20 273 optionally;
#X text 10 291 bash to zero;
#X text 25 246 ATTACK:;
#X text 49 477 When you send this patch a positive trigger it schedules a line~ to do an attack and decay \, and if zero \, it starts the release ramp.;
#X text 495 629 Updated for Pd version 0.37;
#X text 255 89 test for negative trigger;
#X text 253 113 if so \, zero;
#X text 254 129 the output;
#X text 278 165 in any case;
#X text 303 355 multiply by peak level;
#X text 280 286 delay for sustain;
#X text 276 328 convert from percent;
#X text 155 340 ... then;
#X text 103 359 recall peak level;
#X text 439 113 peak;
#X text 281 149 ... do this;
#X text 47 529 Negative triggers cause the output to jump to zero and then attack (instead of attacking from the current location).;
#X text 208 1 Arguments: level \, attack time \, decay time \, sustain level \, release time. A \, D \, and R are in msec and S is in percent. This patch is used as an abstraction in various examples.;
#X connect 0 0 3 0;
#X connect 1 0 5 1;
#X connect 1 0 18 1;
#X connect 3 0 15 0;
#X connect 3 0 16 0;
#X connect 3 1 39 0;
#X connect 4 0 5 0;
#X connect 4 0 8 0;
#X connect 5 0 6 0;
#X connect 6 0 9 0;
#X connect 7 0 6 1;
#X connect 7 0 8 1;
#X connect 8 0 10 0;
#X connect 9 0 19 0;
#X connect 10 0 31 0;
#X connect 11 0 9 0;
#X connect 12 0 11 1;
#X connect 13 0 10 1;
#X connect 14 0 16 1;
#X connect 15 0 8 0;
#X connect 16 0 9 0;
#X connect 18 0 11 0;
#X connect 31 0 18 0;
#X connect 39 0 40 0;
#X connect 39 1 4 0;
#X connect 40 0 4 0;
#X connect 40 1 41 0;
#X connect 41 0 9 0;
#X restore 291 450 pd adsr;
#X f 22;
#X obj 25 380 t f f, f 7;
#X obj 25 327 t b f b b, f 10;
#X obj 108 391 samplerate~;
#X obj 108 423 / 110000;
#X obj 530 202 mtof;
#X obj 530 228 * 1000;
#X text 356 98 note \, velocity \, channel;
#X obj 248 73 t a a;
#X obj 275 97 unpack f f f;
#X text 79 615 left;
#X text 193 615 right;
#X obj 135 639 *~;
#X obj 135 680 outlet~;
#X obj 135 659 *~ 0.3;
#X obj 53 52 route adsr instrument_uuid;
#X msg 120 197 set \$1-sample_lengths;
#X obj 140 270 tabread;
#X obj 23 615 tabread4~;
#X obj 135 615 tabread4~;
#N canvas 962 1105 720 847 pick_closest_sample 0;
#X obj 126 31 inlet;
#X obj 126 445 outlet;
#X floatatom 126 52 5 0 0 1 incoming\ midi\ note - - 0;
#X floatatom 331 425 5 0 0 1 reference\ midi\ note - - 0;
#X obj 126 135 i;
#X floatatom 126 422 5 0 0 0 reference\ octave - - 0;
#X obj 331 445 outlet;
#X obj 126 114 / 12;
#X obj 126 93 t f f, f 7;
#X obj 235 114 % 12;
#X obj 165 167 * 12;
#X floatatom 235 167 5 0 0 1 reference\ pitch\ class - - 0;
#X obj 235 188 > 6;
#X obj 236 445 outlet;
#X text 233 465 C or F#;
#X obj 235 210 sel 0 1, f 16;
#X obj 331 404 +, f 6;
#X symbolatom 236 423 6 0 0 0 - - - 0;
#X msg 236 381 C;
#X obj 236 402 tosymbol;
#X msg 266 381 F#;
#X obj 246 235 bng 16 250 50 0 empty empty empty 0 -8 0 10 #fcfcfc #000000 #000000;
#X obj 296 235 bng 16 250 50 0 empty empty empty 0 -8 0 10 #fcfcfc #000000 #000000;
#X obj 281 263 t b b;
#X obj 235 263 t b b;
#X msg 349 371 0;
#X msg 379 371 6;
#X text 153 71 centralize the reference note;
#X obj 126 72 + 3;
#X obj 126 167 - 2;
#X connect 0 0 2 0;
#X connect 2 0 28 0;
#X connect 3 0 6 0;
#X connect 4 0 10 0;
#X connect 4 0 29 0;
#X connect 5 0 1 0;
#X connect 7 0 4 0;
#X connect 8 0 7 0;
#X connect 8 1 9 0;
#X connect 9 0 11 0;
#X connect 10 0 16 0;
#X connect 11 0 12 0;
#X connect 12 0 15 0;
#X connect 15 0 21 0;
#X connect 15 0 24 0;
#X connect 15 1 22 0;
#X connect 15 1 23 0;
#X connect 16 0 3 0;
#X connect 17 0 13 0;
#X connect 18 0 19 0;
#X connect 19 0 17 0;
#X connect 20 0 19 0;
#X connect 23 0 20 0;
#X connect 23 1 26 0;
#X connect 24 0 18 0;
#X connect 24 1 25 0;
#X connect 25 0 16 1;
#X connect 26 0 16 1;
#X connect 28 0 8 0;
#X connect 29 0 5 0;
#X restore 275 118 pd pick_closest_sample;
#X f 42;
#X text 283 136 octave;
#X text 409 136 note name;
#X text 539 136 midi note;
#X obj 275 199 pack f s f;
#X text 289 219 octave \, note name \, instrument_uuid;
#X msg 275 268 set \$3-\$2\$1_L;
#X msg 387 268 set \$3-\$2\$1_R;
#X obj 240 168 + 2;
#X connect 0 0 20 0;
#X connect 1 0 13 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 37 0;
#X connect 4 0 38 0;
#X connect 5 0 21 0;
#X connect 6 0 15 0;
#X connect 7 0 8 0;
#X connect 8 0 19 0;
#X connect 8 1 19 1;
#X connect 9 0 19 2;
#X connect 9 1 19 3;
#X connect 9 2 19 4;
#X connect 9 3 19 5;
#X connect 10 0 18 0;
#X connect 11 0 6 0;
#X connect 11 1 6 1;
#X connect 11 1 7 0;
#X connect 12 0 13 1;
#X connect 13 0 2 1;
#X connect 14 0 12 1;
#X connect 15 0 5 0;
#X connect 16 0 34 0;
#X connect 18 0 17 0;
#X connect 19 0 10 1;
#X connect 19 0 31 1;
#X connect 20 0 2 0;
#X connect 20 1 1 0;
#X connect 21 0 0 0;
#X connect 21 1 12 0;
#X connect 21 3 22 0;
#X connect 22 0 23 0;
#X connect 23 0 14 0;
#X connect 24 0 25 0;
#X connect 25 0 23 1;
#X connect 27 0 11 0;
#X connect 27 1 28 0;
#X connect 28 0 39 0;
#X connect 31 0 33 0;
#X connect 33 0 32 0;
#X connect 34 0 9 0;
#X connect 34 1 35 0;
#X connect 34 1 43 2;
#X connect 34 2 27 0;
#X connect 35 0 36 0;
#X connect 36 0 0 1;
#X connect 37 0 10 0;
#X connect 38 0 31 0;
#X connect 39 0 43 0;
#X connect 39 0 47 0;
#X connect 39 1 43 1;
#X connect 39 2 24 0;
#X connect 43 0 45 0;
#X connect 43 0 46 0;
#X connect 45 0 37 0;
#X connect 46 0 38 0;
#X connect 47 0 36 0;
